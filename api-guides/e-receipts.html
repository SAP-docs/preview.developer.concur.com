<!DOCTYPE html>
<html lang="en">

<head>
  


  <title> SAP Concur Developer Center | E-Receipts and Quick Expense Integration Guide For User Apps</title>


<!-- Meta -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="The starting point for anyone interested in integrating with the SAP Concur platform that reaches 80 million end users.">
<meta name="author" content="">

<!-- Sitemap link -->
<link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />

<!-- Favicon -->
<link rel="shortcut icon" href="/assets/img/square-sap-favicon.png" type="image/png">

<!-- Adobe Analytics Global-->
<script src="https://assets.adobedtm.com/e1226b306979/aeb854337dc8/launch-85c98625c1e8.min.js" async></script>

<!-- Canonical link-->
<link rel="canonical" href="https://preview.developer.concur.com/api-guides/e-receipts.html" data-proofer-ignore>

<!-- CSS Global Compulsory -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400">
<link rel="stylesheet" href="/assets/style.css">

<!-- CSS Implementing Plugins -->
<link rel="stylesheet" href="/assets/plugins/font-awesome/css/all.min.css">



<link rel="alternate" type="application/rss+xml" title="SAP Concur Developer Center RSS" href="/feed.xml" />

</head>

<body>


  <div class="wrapper page-option-v1">
    <div class="hidden-print">
  <nav id="header-navbar" class="navbar navbar-inverse hidden-print">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header col-6">
        <button type="button" class="navbar-toggle collapsed" style="color: white" data-toggle="collapse" data-target="#nav-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">
          <img src="/assets/img/sap-concur-logo-white.png" alt="Logo">
          <div class="app-name">Developer Center</div>
        </a>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse col-6" id="nav-collapse-1">
        <ul class="nav navbar-nav navbar-right" style="padding-top: 9px">
          <!-- Development -->
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" style="color: white" role="button" aria-haspopup="true">
              Development <span class="caret"></span>
            </a>
            <ul class="dropdown-menu multi-column three-column-menu">
              <div class="row">
                <div class="col-sm-4">
                  <ul class="multi-column-dropdown">
                    <li class="column-icon">
                      <span class="fa-stack fa-lg">
                        <i class="fas fa-circle fa-stack-2x"></i>
                        <i class="fas fa-map-marked-alt fa-stack-1x fa-inverse"></i>
                      </span>
                    </li>
                    <li class="column-title">About</li>
                    <li><a href="/getting-started.html">Getting Started</a></li>
                    <li><a href="/api-reference/authentication/getting-started.html">Authentication</a></li>
                    <li><a href="/platform/index.html">Platform</a></li>
                    <li><a href="/tools-support/deprecation-policy.html">API Deprecation</a></li>
                  </ul>
                </div>
                <div class="col-sm-4">
                  <ul class="multi-column-dropdown">
                    <li class="column-icon">
                      <span class="fa-stack fa-lg">
                        <i class="fas fa-circle fa-stack-2x"></i>
                        <i class="fas fa-book fa-stack-1x fa-inverse"></i>
                      </span>
                    </li>
                    <li class="column-title">Documentation</li>
                    <li><a href="/api-reference/">API Reference</a></li>
                    <li><a href="/api-explorer/">API Explorer</a></li>
                    <li><a href="/api-guides/">API Guides</a></li>
                    <li><a href="/event-topics/">Event Topics</a></li>
                  </ul>
                </div>
                <div class="col-sm-4">
                  <ul class="multi-column-dropdown">
                    <li class="column-icon">
                      <span class="fa-stack fa-lg">
                        <i class="fas fa-circle fa-stack-2x"></i>
                        <i class="fas fa-clipboard-list fa-stack-1x fa-inverse"></i>
                      </span>
                    </li>
                    <li class="column-title">UX Guidelines</li>
                    <li><a href="/manage-apps/go-market-docs/app-center-ux-guidelines-enterprise.html">Enterprise Applications</a></li>
                    <li><a href="/manage-apps/go-market-docs/app-center-ux-guidelines-consumer.html">User Connections</a>
                    </li>
                  </ul>
                </div>
              </div>
            </ul>
          </li>
          <!-- Partner Resources -->
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" style="color: white" aria-haspopup="true" aria-expanded="false">
              Partner Resources <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
              <li class="column-icon">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fas fa-lightbulb fa-stack-1x fa-inverse"></i>
                </span>
              </li>
              <li class="column-title">Partner Resources</li>
              <li><a href="/manage-apps/app-certification.html">App Certification</a></li>
              <li><a href="/manage-apps/partner-applications.html">App Registration & Management</a></li>
              <li><a href="https://www.concur.com/en-us/app-center" target="_blank">App Center</a></li>
              <li><a href="https://www.concursolutions.com/" target="_blank">Login to Concur</a></li>
            </ul>
          </li>
          <!-- Support -->
          <li
            class="dropdown">
            <a href="#" class="dropdown-toggle" style="color: white" data-toggle="dropdown" role="button" aria-haspopup="true">
              Support <span class="caret"></span>
            </a>
            <ul class="dropdown-menu multi-column two-column-menu">
              <div class="row">
                <div class="col-sm-6">
                  <ul class="multi-column-dropdown">
                    <li class="column-icon">
                      <span class="fa-stack fa-lg">
                        <i class="fas fa-circle fa-stack-2x"></i>
                        <i class="fas fa-question fa-stack-1x fa-inverse"></i>
                      </span>
                    </li>
                    <li class="column-title">Support</li>
                    <li><a href="/tools-support/support.html">Support Options</a></li>
                    <li><a href="https://open.concur.com/" target="_blank">Service Status</a></li>
                  </ul>
                </div>
                <div class="col-sm-6">
                  <ul class="multi-column-dropdown">
                    <li class="column-icon">
                      <span class="fa-stack fa-lg">
                        <i class="fas fa-circle fa-stack-2x"></i>
                        <i class="fas fa-bullhorn fa-stack-1x fa-inverse"></i>
                      </span>
                    </li>
                    <li class="column-title">Bulletin</li>
                    <li><a href="/tools-support/release-notes/index.html">Release Notes</a></li>
                  </ul>
                </div>
              </div>
            </ul>
          </li>
          <!-- Search -->
          <li>
            <a href="#" class="search">
              <span class="sr-only">Search</span>
              <i class="fas fa-search search-btn" style="color:white;"></i>
            </a>
            <div class="search-open">
              <div class="input-group animated fadeInDown">
                <form method="GET" action="/search.html" id="searchbox_000165422556797149853:qlbg8re_3tu">
                  <input value="000165422556797149853:qlbg8re_3tu" name="cx" type="hidden">
                  <input value="FORID:11" name="cof" type="hidden"> <!-- FORID values configure ad positions -->
                  <div class="input-group">
                    <label for="q" hidden>Search</label>
                    <input type="text" id="q" class="form-control" name="q" placeholder="Search">
                    <span class="input-group-btn">
                      <button type="submit" class="btn bright-blue">Go</button>
                    </span>
                  </div>
                </form>
              </div>
            </div>
          </li>
        </ul> <!-- /.navbar-nav -->
      </div> <!-- /.navbar-collapse -->
  </nav> <!-- /.navbar -->
</div>


    <div id="main-content"
         class="main-content">
      <div class="container-fluid content">
  <div class="row">
    <div id="left-navigation"
         class="col-md-2 left-navigation">
      







<ul class="list-group sidebar-nav-v1 hidden-print" id="sidebar-nav">





  
    <li class="list-group-item ">
      <a href="/api-guides/">Integration Guides</a>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-attendees">
        Attendees
      </a>
      <ul id="collapse-attendees" class="collapse ">
        
          <li >
            <a href="/api-guides/attendees/external-attendees-to-expense-entries.html">Expense - Associating External Attendees to Expense Entries</a>
          </li>
        
      </ul>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-authentication">
        Authentication
      </a>
      <ul id="collapse-authentication" class="collapse ">
        
          <li >
            <a href="/api-guides/authentication/concur-get-refresh-token/concur-get-refresh-token.html">Tutorial 1. Create Tokens Required for SAP Concur API Access</a>
          </li>
        
          <li >
            <a href="/api-guides/authentication/concur-refresh-token-management/concur-refresh-token-management.html">Tutorial 2. Refresh Token Management Automation</a>
          </li>
        
          <li >
            <a href="/api-guides/authentication/concur-calling-apis/concur-calling-apis.html">Tutorial 3. Call SAP Concur APIs Using A Multiple Use Bearer Token</a>
          </li>
        
      </ul>
    </li>

  



  
    <li class="list-group-item active">
      <a href="/api-guides/e-receipts.html">eReceipts Integration</a>
    </li>

  



  
    <li class="list-group-item ">
      <a href="/api-guides/ess-guide.html">Event Subscription Service v4 Guide</a>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-expense">
        Expense
      </a>
      <ul id="collapse-expense" class="collapse ">
        
          <li >
            <a href="/api-guides/expense/cost-object-workflow-integration.html">Cost Object Workflow Integration</a>
          </li>
        
          <li >
            <a href="/api-guides/expense/deeplink-url.html">Deeplink URL</a>
          </li>
        
          <li >
            <a href="/api-guides/expense/mexico-cfdi-integration.html">Mexico CFDI Integration Guide</a>
          </li>
        
      </ul>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-erp-integration">
        ERP Integration
      </a>
      <ul id="collapse-erp-integration" class="collapse ">
        
          <li >
            <a href="/api-guides/ERP-integration/erp-integration.html">ERP Integrations</a>
          </li>
        
          <li >
            <a href="/api-guides/ERP-integration/posting-via-financial-integration-service.html">Financial Posting via Financial Integration Service</a>
          </li>
        
          <li >
            <a href="/api-guides/ERP-integration/posting-via-extracts.html">Financial Posting via Extracts</a>
          </li>
        
      </ul>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-invoice">
        Invoice
      </a>
      <ul id="collapse-invoice" class="collapse ">
        
          <li >
            <a href="/api-guides/invoice/payment-provider-integration.html">Payment Provider Integration - paying customers' invoices</a>
          </li>
        
      </ul>
    </li>

  



  
    <li class="list-group-item ">
      <a href="/api-guides/preproduction-testing.html">Testing App Center Partner Applications</a>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-profile">
        Profile
      </a>
      <ul id="collapse-profile" class="collapse ">
        
          <li >
            <a href="/api-guides/profile/identity-search.html">Identity v4.1 Search Guide</a>
          </li>
        
      </ul>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-request">
        Request
      </a>
      <ul id="collapse-request" class="collapse ">
        
          <li >
            <a href="/api-guides/request/deeplink-url-request.html">Deeplink URL Integration</a>
          </li>
        
      </ul>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-tmc">
        TMC
      </a>
      <ul id="collapse-tmc" class="collapse ">
        
          <li >
            <a href="/api-guides/tmc/tmc-overview.html">TMC Guide Overview</a>
          </li>
        
          <li >
            <a href="/api-guides/tmc/itinerary-v1-guide.html">Guide to the Itinerary v1.0 API, TMC Edition</a>
          </li>
        
          <li >
            <a href="/api-guides/tmc/profile-v2-guide.html">Guide to the Profile v2.0 API, TMC Edition</a>
          </li>
        
          <li >
            <a href="/api-guides/tmc/receipts-v4-guide.html">Guide to the Receipts v4.0 API, TMC Edition</a>
          </li>
        
          <li >
            <a href="/api-guides/tmc/request-v4-guide.html">Guide to the Request v4.0 API, TMC Edition</a>
          </li>
        
      </ul>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-travel">
        Travel
      </a>
      <ul id="collapse-travel" class="collapse ">
        
          <li >
            <a href="/api-guides/travel/deeplink-integration.html">Deep Link Integration</a>
          </li>
        
          <li >
            <a href="/api-guides/travel/duty-of-care.html">Duty of Care</a>
          </li>
        
          <li >
            <a href="/api-guides/travel/get-itinerary.html">Itinerary - GET Itinerary & Trip Details</a>
          </li>
        
          <li >
            <a href="/api-guides/travel/new-itinerary-manual.html">Itinerary - Add a New Itinerary Manually</a>
          </li>
        
          <li >
            <a href="/api-guides/travel/itin-with-events.html">Itinerary - Business Travel Events</a>
          </li>
        
      </ul>
    </li>

  



  

    

    

    

    <li class="list-group-item list-toggle ">
      <a data-toggle="collapse" data-parent="#sidebar-nav" href="#collapse-user-provisioning">
        User Provisioning
      </a>
      <ul id="collapse-user-provisioning" class="collapse ">
        
          <li >
            <a href="/api-guides/user-provisioning/user-provisioning.html">User Provisioning</a>
          </li>
        
      </ul>
    </li>

  



  
    <li class="list-group-item ">
      <a href="/api-guides/vat-reclaim/vat-reclaim-guide.html">VAT Reclaim Integration</a>
    </li>

  



</ul>

    </div>
    <!--/col-md-3-->

    
      <div id="markdown-body"
           class="col-md-8 markdown-body">
        

        <h1 id="e-receipts-and-quick-expense-user-app-integration-guide">E-Receipts and Quick Expense User App Integration Guide</h1>

<p>E-receipts are digital representations of receipts with both a receipt image and structured data. The e-receipts come from pre-authorized and trusted merchants and are transmitted to the SAP Concur platform using our <strong>Receipt</strong> API (not email) on behalf of individual users who have connected their accounts/profiles between us and the merchant in advance.</p>

<p>Merchants can also use the <strong>Quick Expense</strong> API to create an expense with basic information such as date, amount, and expense type, with or without a receipt image. The eReceipt or Quick Expense can be added to an expense report within Concur Expense, allowing the user to provide additional details such as attendees, itemizations, etc.</p>

<p>This integration guide helps SAP Concur App Center E-Receipt and Quick Expense user app integration partners to develop and list their apps for the App Center.</p>

<h2 id="getting-started">Getting Started</h2>

<p>New App Center Partners: Your company must have entered into a commercial agreement with us. If you have not yet entered into an agreement, review the information on the <a href="https://developer.concur.com/solutions/app-center.html">Build App Center Solutions</a> page.</p>

<p>Existing App Center Partners: The SAP Concur Platform team will need to configure your existing sandbox, among other things to enable access.  You can make that App expansion request by contacting your <a href="mailto:concur_AppCenterAlliance@sap.com?subject=App%20Exapansion%20Request">Alliance Manager</a>.</p>

<p>The E-Receipts and Quick Expense User App needs to be certified before the App is listed in the SAP Concur App Center. Please follow the <a href="/api-guides/e-receipts-certification.html">User App Certification Flow</a> steps to complete your App certification. Please make sure your App achieves all the criteria in <a href="/api-guides/e-receipts-certification.html#certification-check-list">Certification Checklist</a> before you schedule the certification demo with the Certification Project Manager.</p>

<h2 id="development-environment">Development Environment</h2>

<p>SAP Concur Certification Project Manager will prepare the development environment for you and send the development environment details to you by email. The development environment includes:</p>

<h3 id="sandboxes-and-accounts">Sandboxes and Accounts</h3>

<ul>
  <li>You will have a shared sandbox on each of following SAP Concur data centers: US2, EU2.</li>
  <li>You will have 3 test accounts on each of following SAP Concur data centers: US2, EU2.</li>
</ul>

<h3 id="development-app">Development App</h3>

<ul>
  <li>A development app will be created for you by your assigned certification manager. They will send you a deep link (url) to the development app along with the app <code class="language-plaintext highlighter-rouge">client_id</code> and <code class="language-plaintext highlighter-rouge">client_secret</code>. These are provided for development and testing purposes only.</li>
  <li>You need to send the development app’s connect URL (redirect URL) to <a href="mailto:PlatformCertification@sap.com">PlatformCertification@sap.com</a> before starting the development and testing of the development app.</li>
</ul>

<h3 id="production-app">Production App</h3>

<ul>
  <li>Once you complete the development app certification walkthrough, you will be provided a production app <code class="language-plaintext highlighter-rouge">client_id</code> and <code class="language-plaintext highlighter-rouge">client_secret</code>.</li>
  <li>You need to send the production app’s connect URL (redirect URL) to <a href="mailto:PlatformCertification@sap.com">PlatformCertification@sap.com</a>  before starting the development and testing of the production app.</li>
  <li>The certification project manager will provide you the deep link (URL) to the production app listing in the App Center. You will be able to access the app listing for development and testing purposes only. After your production app meets all the certification requirements and completes certification, the App Center marketing team will release it in the App Center and users in allowed regions/countries will have the access.</li>
</ul>

<h2 id="user-connections--authentication">User Connections / Authentication</h2>

<p>Depending on the connection flow, a grant will be selected for authentication. The authentication methods below are available to obtain an <code class="language-plaintext highlighter-rouge">access_token</code>. Password grant, authorization grant, or one-time password grant is required for certification:</p>

<ul>
  <li><a href="/api-reference/authentication/apidoc.html#password-grant">Password Grant</a> - Connect from the SAP Concur App Center.</li>
  <li><a href="/api-reference/authentication/apidoc.html#auth-grant">Authorization Grant</a> - Connect from the partner app.</li>
  <li><a href="/api-reference/authentication/apidoc.html#otp-grant">One-Time Password Grant</a> - Connect from the partner app using email.</li>
</ul>

<h2 id="app-center-flow---connecting-from-sap-concur-app-center">App Center Flow - Connecting from SAP Concur App Center</h2>

<p><a href="https://developer.concur.com/api-reference/authentication/apidoc.html#password-grant">Password grant</a> allows the user to establish a connection from App Center. The user needs to login via their SAP Concur credentials to access the app in the App Center. In the development and testing phase, you would be provided with the app listing solely for the purpose of development and testing. This app listing will be accessed via a deep link. This deep link will be provided to you before you start development. The instructions to connect/authenticate via password grant are:</p>

<ol>
  <li>
    <p>A logged in user clicks the connect button on the app listing in the App Center and authorizes your app to post data. App Listing Example:</p>

    <p><img src="/assets/img/api-guides/e-receipts/app-listing-sample.png" alt="Example of App Center Listing Page" /></p>
  </li>
  <li>
    <p>After the user clicks the “Connect” button, the user will see a prompt with the terms &amp; conditions. User agrees the terms and conditions and clicks the “I Agree” button.</p>

    <p><img src="/assets/img/api-guides/e-receipts/app-listing-terms-conditions.png" alt="Screenshot of App Listing Terms and Conditions" /></p>
  </li>
  <li>
    <p>The authorization service will redirect the user to your app’s <a href="https://developer.concur.com/manage-apps/go-market-docs/app-center-partner-marketing-toolkit.html#landing-pages">landing page</a>. Please follow the <a href="https://developer.concur.com/manage-apps/go-market-docs/app-center-ux-guidelines-consumer.html">App Center Design Guidelines</a> to create a web page that listens for an HTTP GET request. The <a href="https://developer.concur.com/manage-apps/go-market-docs/app-center-ux-guidelines-consumer.html#guideline-checklist">Guideline Checklist</a> provides a list of required and recommended components of your landing page design. Please make sure all the required options are checked before scheduling the certification walkthrough. You must prepare separate landing pages for the development environment and the production environment. You must send the landing page redirect URIs to <a href="mailto:PlatformCertification@sap.com">PlatformCertification@sap.com</a> before starting  development.</p>
  </li>
  <li>
    <p>Your landing page should allow the user to log in with an existing account or create a new account.</p>

    <p><img src="/assets/img/api-guides/e-receipts/app-center-partner-user-validation.png" alt="Sample of Partner App Validate User Identity" /></p>
  </li>
  <li>
    <p>The redirect URI will contain <code class="language-plaintext highlighter-rouge">id</code> and <code class="language-plaintext highlighter-rouge">requestToken</code> parameters. Example: <code class="language-plaintext highlighter-rouge">https://{partner-redirect-URI}?id=8568a4cd-8ffc-49d6-9417-be2d69aa075f&amp;requestToken=5l85ae5a-426f-4d6f-8af4-08648c4b696b</code></p>
  </li>
  <li>
    <p>When your application receives the redirect call, strip the <code class="language-plaintext highlighter-rouge">id</code> and <code class="language-plaintext highlighter-rouge">requestToken</code> values from the URI.</p>
  </li>
  <li>
    <p>Use <code class="language-plaintext highlighter-rouge">id</code> as the <code class="language-plaintext highlighter-rouge">username</code> parameter value and <code class="language-plaintext highlighter-rouge">requestToken</code> as the <code class="language-plaintext highlighter-rouge">password</code> parameter value on a post request to the SAP Concur authorization service to obtain the official OAuth2 <code class="language-plaintext highlighter-rouge">access_token</code> and <code class="language-plaintext highlighter-rouge">refresh_token</code> for the user using the <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#password-grant">password grant</a> while <a href="https://developer.concur.com/api-guides/e-receipts.html#being-geo-aware">being geo aware</a>.</p>

    <ul>
      <li>There are two credential types allowed with password grant, <code class="language-plaintext highlighter-rouge">password</code> and <code class="language-plaintext highlighter-rouge">authtoken</code>. For the App Center partner, please use the <code class="language-plaintext highlighter-rouge">authtoken</code> credential type for the connections from the App Center.</li>
      <li>Do not post the request to the authorization service before confirming user identification in their App.</li>
      <li>Please refer <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#password-grant-">password grant</a> for the post body description.</li>
    </ul>

    <p><strong>Example : Password Grant</strong></p>

    <p><strong>Request</strong></p>

    <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/oauth2/v0/token</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">glz.api.concursolutions.com</span>
</code></pre></div>    </div>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>client_id={client_id}
&amp;client_secret={client_secret}
&amp;grant_type=password
&amp;username ={‘id’ from the redirect URL}
&amp;password ={‘requestToken’ from the redirect URL}
&amp;credtype= authtoken
</code></pre></div>    </div>

    <p><strong>Response</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: application/json
</code></pre></div>    </div>
    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
</span><span class="nl">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3600"</span><span class="p">,</span><span class="w">
</span><span class="nl">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{app-scopes}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
</span><span class="nl">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{access_token}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{refresh_token}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"refresh_expires_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{expiration time}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"id_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{id_token}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"geolocation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://us2.api.concursolutions.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>Decode the <code class="language-plaintext highlighter-rouge">id_token</code> to obtain the sub value and store this value as the user <code class="language-plaintext highlighter-rouge">id</code> (see <a href="https://jwt.io/">https://jwt.io</a>).</li>
  <li>An <code class="language-plaintext highlighter-rouge">access_token</code> is valid only for <strong>one hour</strong>. The <code class="language-plaintext highlighter-rouge">access_token</code> should be cached in memory and discarded after use.</li>
  <li>
    <p>After the user has successfully completed the login/enrollment process, store the following with the user’s profile in your database.</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">refresh_token</code>: (36 characters including dashes) valid for six months from the day and time issued.</li>
      <li><code class="language-plaintext highlighter-rouge">refresh_expires_in</code>: expiration date &amp; time in Epoch time format, please convert to UTC format.</li>
      <li><code class="language-plaintext highlighter-rouge">geolocation</code>: to be used as the base URI when making API calls on behalf of the user.</li>
      <li><code class="language-plaintext highlighter-rouge">sub</code>: (36 characters including dashes) The user id will be used to post receipts to the user’s SAP Concur account.</li>
    </ul>
  </li>
  <li>
    <p>Confirm visually to the user that their partner app account has been successfully linked with their SAP Concur account.</p>
  </li>
  <li>You now can use the <code class="language-plaintext highlighter-rouge">access_token</code> for making API calls.</li>
</ol>

<h2 id="web-flow---connecting-from-the-partner-web-or-mobile-app">Web Flow - Connecting from the Partner Web or Mobile App</h2>

<p><a href="/api-reference/authentication/apidoc.html#authorization-grant-">Authorization Grant</a> allows the user to connect directly from your website or the mobile app.</p>

<ol>
  <li>
    <p>User clicks <strong>Link to Concur</strong> button within your website or mobile App. Partner Web or Mobile Connection Example:</p>

    <p><img src="/assets/img/api-guides/e-receipts/auth-connect-from-partner-app.png" alt="Sample of a Partner Web App UI" /></p>
  </li>
  <li>
    <p>Your app will make a call to the authorization service.</p>
  </li>
</ol>

<blockquote>
  <p><strong><em>NOTE:</em></strong>  the grant type must be accessed using the <code class="language-plaintext highlighter-rouge">www-</code> version of the API Gateway in order to avoid certificate issues with some browsers. (ex: https://www-glz.api.concursolutions.com instead of https://glz.api.concursolutions.com)</p>
</blockquote>

<p>Example:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">   </span><span class="nf">GET</span> <span class="nn">/oauth2/v0/authorize?client_id={your-app-clientId}&amp;redirect_uri={partner_redirect_URI}&amp;response_type=code</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="s">   Host: https://www-glz.api.concursolutions.com</span>
</code></pre></div></div>

<ol>
  <li>
    <p>The authorization service will prompt the user with two options: <strong>Username</strong> or <strong>Send a link to my email</strong></p>

    <p><img src="/assets/img/api-guides/e-receipts/auth-options.png" alt="Screenshot of Sign In Options" /></p>
  </li>
  <li>
    <p>Handling the <strong>username/password</strong> option:</p>

    <ul>
      <li>
        <p>When users choose the <strong>username/password</strong> option, the authorization service will prompt the user to enter their SAP Concur credentials.</p>

        <p><img src="/assets/img/api-guides/e-receipts/auth-sign-in-password.png" alt="Screenshot of the Sign In Form" /></p>
      </li>
      <li>
        <p>After successfully logging in, the user will be redirected to the partner’s redirect URI with a query parameter containing a one time use code and user’s geolocation, which will be used to obtain an official OAuth2 <code class="language-plaintext highlighter-rouge">access_token</code> and <code class="language-plaintext highlighter-rouge">refresh_token</code>.</p>

        <p>Example: <code class="language-plaintext highlighter-rouge">https://{partner_redirect_URI}?geolocation={geolocation}&amp;code={code}</code></p>
      </li>
    </ul>
  </li>
  <li>
    <p>Handling the <strong>email</strong> option:</p>

    <ul>
      <li>The email option is designed for users who do not want to use passwords or those that do not have passwords such as single sign-on (SSO) users.</li>
      <li>
        <p>Email is sent IF the user provides their <strong>primary</strong> SAP Concur email address (email1).</p>

        <p><img src="/assets/img/api-guides/e-receipts/email1-setting.png" alt="Sample of Primary Email/Email1 Setting" /></p>
      </li>
      <li>
        <p>After the user clicks the “Sign in with Concur” link within the email, the user will be redirected to your redirect URI with a query parameter containing a one-time use code and user’s geolocation, which will be used to obtain an official OAuth2 <code class="language-plaintext highlighter-rouge">access_token</code> and <code class="language-plaintext highlighter-rouge">refresh_token</code>.</p>

        <p>Example: <code class="language-plaintext highlighter-rouge">https://{partner_redirect_URI}?geolocation={geolocation}&amp;code={code}</code></p>

        <p><img src="/assets/img/api-guides/e-receipts/auth-mail.png" alt="Sample of Auth Email" /></p>
      </li>
    </ul>
  </li>
  <li>
    <p>When your application receives the redirect call with the code and user’s geolocation, strip the <code class="language-plaintext highlighter-rouge">code</code> value and user’s <code class="language-plaintext highlighter-rouge">geolocation</code> from the redirect URI to use on a post request to the authorization service to obtain an official OAuth2 <code class="language-plaintext highlighter-rouge">access_token</code> and <code class="language-plaintext highlighter-rouge">refresh_token</code> using the <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#auth-grant">authorization grant</a>. Refer to authentication grant documentation for the post body description.</p>

    <p><strong>Example: Authorization Grant – Request An Access Token</strong></p>

    <p><strong>Request</strong></p>

    <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/oauth2/v0/token</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">glz.api.concursolutions.com</span>
</code></pre></div>    </div>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>client_id={client_id}
&amp;client_secret={client_secret}
&amp;grant_type=authorization_code
&amp;redirect_uri={redirect_uri}&amp;code={code}
</code></pre></div>    </div>

    <p><strong>Response</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: application
</code></pre></div>    </div>
    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
</span><span class="nl">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3600"</span><span class="p">,</span><span class="w">
</span><span class="nl">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{app-scopes}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
</span><span class="nl">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{access_token}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{refresh_token}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"refresh_expires_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{expiration time}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"id_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{id_token}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"geolocation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://us2.api.concursolutions.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>Decode the <code class="language-plaintext highlighter-rouge">id_token</code> to obtain the <code class="language-plaintext highlighter-rouge">sub</code> value and store this value as the user <code class="language-plaintext highlighter-rouge">id</code> (see <a href="https://jwt.io/">https://jwt.io</a>).</p>
  </li>
  <li>
    <p>An <code class="language-plaintext highlighter-rouge">access_token</code> is valid only for <strong>one hour</strong>. The <code class="language-plaintext highlighter-rouge">access_token</code> should be cached in memory and discarded after use.</p>
  </li>
  <li>
    <p>Store the following with the user’s profile in your database.</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">refresh_token</code>: (36 characters including dashes) valid for six months from the day and time issued.</li>
      <li><code class="language-plaintext highlighter-rouge">refresh_expires_in</code>: expiration date &amp; time in Epoch time format, please convert to UTC format.</li>
      <li><code class="language-plaintext highlighter-rouge">geolocation</code>: to be used as the base URI when making API calls on behalf of the user.</li>
      <li><code class="language-plaintext highlighter-rouge">sub</code>: (36 characters including dashes) The user id will be used to post receipts to the user’s SAP Concur account.</li>
    </ul>
  </li>
  <li>
    <p>Confirm visually to the user that their partner app account has been successfully linked with their SAP Concur account, and that the receipts will be posted to the user’s SAP Concur account after payment.</p>
  </li>
</ol>

<h2 id="connect-from-the-partner-app-using-email">Connect from the Partner App Using Email</h2>

<p>The <a href="/api-reference/authentication/apidoc.html#otp-grant">one-time password grant</a> leverages email to provide per user access tokens to client applications. This grant type requires the following steps:</p>

<ol>
  <li>
    <p>User enters their email address associated with the SAP Concur profile within the partner’s website or mobile app. Partner one-time password (OTP) Connection Example below:</p>

    <p><img src="/assets/img/api-guides/e-receipts/otp-send-email.png" alt="Example of what an App Center partner might display on their own site to allow their users to connect their user account at the partner with their SAP Concur account, using the one-time password flow." /></p>
  </li>
  <li>
    <p>User clicks the Link/Connect button. <strong>Note</strong>: User may have more than one email associated with their SAP Concur profile.The email address used for this method should be the email address listed as Email1 on the user’s SAP Concur profile.</p>

    <p><img src="/assets/img/api-guides/e-receipts/email1-setting.png" alt="Example of Primary Email Setting" /></p>
  </li>
  <li>
    <p>Your app will make a call to the authorization service to trigger the OTP email using <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#otp-grant">OTP grant</a> while <a href="https://developer.concur.com/api-guides/e-receipts.html#being-geo-aware">being geo aware</a>. Refer <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#one-time-password-grant-">Request a one-time token</a> for the post body descriptions. The following are reserved words and cannot be used as client application defined parameters for <code class="language-plaintext highlighter-rouge">/otp</code> API: <code class="language-plaintext highlighter-rouge">client_id</code>,<code class="language-plaintext highlighter-rouge">client_secret</code>,<code class="language-plaintext highlighter-rouge">channel_type</code>,<code class="language-plaintext highlighter-rouge">channel_handle</code></p>

    <p><strong>Example</strong></p>

    <p><strong>Request</strong></p>

    <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/oauth2/v0/otp</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">us.api.concursolutions.com</span>
</code></pre></div>    </div>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>client_id={client_id}
&amp;client_secret={client_secret}
&amp;channel_type=email
&amp;channel_handle=william.never@companydemo.com
&amp;name=William Never
&amp;company=Company Demo
&amp;link=https://connect.companydemo.com/auth
</code></pre></div>    </div>

    <p><strong>Response</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: application/json
{
    "message": "opt sent"
}
</code></pre></div>    </div>
  </li>
  <li>
    <p>User will receive the email with ‘Sign in with Concur’ button.</p>

    <p><img src="/assets/img/api-guides/e-receipts/otp-email-sample.png" alt="Sample OTP Email User Received" /></p>
  </li>
  <li>
    <p>After user clicks the “Sign in with Concur” link within the email, they will be redirected to the partner’s redirect URI with a query parameter <strong><code class="language-plaintext highlighter-rouge">token</code></strong> containing a one-time token that will be used to obtain an official OAuth2 <code class="language-plaintext highlighter-rouge">access_token</code> and <code class="language-plaintext highlighter-rouge">refresh_token</code>. Example: <code class="language-plaintext highlighter-rouge">https://connect.companydemo.com/auth&amp;token=dd-36w6vji244m5qsfy23a3jvw3no1e4c</code></p>
  </li>
  <li>
    <p>When your application receives the redirect call with the one-time token, strip the token value from the redirect URI and use that token on a Post request to the authorization service to obtain an official OAuth2 <code class="language-plaintext highlighter-rouge">access_token</code> and <code class="language-plaintext highlighter-rouge">refresh_token</code> using the <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#otp-grant">OTP grant</a> while <a href="https://developer.concur.com/api-guides/e-receipts.html#being-geo-aware">being geo aware</a>.</p>
  </li>
  <li>If you used the optional parameters in the /otp call in step 3, such as ‘name’, ‘company’ and ‘link’, please include these parameters in the following /auth API call too.</li>
  <li>
    <p>The following are reserved words and cannot be used as client application defined parameters for <code class="language-plaintext highlighter-rouge">/token</code> API: <code class="language-plaintext highlighter-rouge">client_id</code>,<code class="language-plaintext highlighter-rouge">client_secret</code>,<code class="language-plaintext highlighter-rouge">channel_type</code>,<code class="language-plaintext highlighter-rouge">channel_handle</code>,<code class="language-plaintext highlighter-rouge">scope</code>,<code class="language-plaintext highlighter-rouge">grant_type</code>,<code class="language-plaintext highlighter-rouge">otp</code>.</p>

    <p><strong>Example:</strong></p>

    <p><strong>Request</strong></p>

    <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/oauth2/v0/token</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">us.api.concursolutions.com</span>
</code></pre></div>    </div>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>client_id={client_id}
&amp;client_secret={client_secret}
&amp;grant_type=otp
&amp;otp={one_time_token}
&amp;channel_type=email
&amp;channel_handle=william.never@companydemo.com
&amp;name=William Never
&amp;company=Company Demo
&amp;link=https://connect.companydemo.com/auth
</code></pre></div>    </div>

    <p><strong>Response</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: application/json
</code></pre></div>    </div>
    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
</span><span class="nl">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3600"</span><span class="p">,</span><span class="w">
</span><span class="nl">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{app-scopes}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
</span><span class="nl">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{access_token}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{refresh_token}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"refresh_expires_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{expiration time}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"id_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{id_token}"</span><span class="p">,</span><span class="w">
</span><span class="nl">"geolocation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://us2.api.concursolutions.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>Decode the <code class="language-plaintext highlighter-rouge">id_token</code> to obtain the <code class="language-plaintext highlighter-rouge">sub</code> value and store this value as the user <code class="language-plaintext highlighter-rouge">id</code> (see <a href="https://jwt.io/">https://jwt.io</a>).</p>
  </li>
  <li>
    <p>An <code class="language-plaintext highlighter-rouge">access_token</code> is valid only for <strong>one hour</strong>. The access token should be cached in memory and discarded after use.</p>
  </li>
  <li>
    <p>Store the following with the users profile in your database.</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">refresh_token</code>: (36 characters including dashes) valid for six months from the day and time issued.</li>
      <li><code class="language-plaintext highlighter-rouge">refresh_expires_in</code>: expiration date &amp; time in Epoch time format, please convert to UTC format.</li>
      <li><code class="language-plaintext highlighter-rouge">geolocation</code>: to be used as the base URI when making API calls on behalf of the user.</li>
      <li><code class="language-plaintext highlighter-rouge">sub</code>: (36 characters including dashes) The user id will be used to post receipts to the user’s SAP Concur account.</li>
    </ul>
  </li>
  <li>Confirm visually to the user that their partner app account has been successfully linked with their SAP Concur account, and that the receipts will be posted to the user’s SAP Concur account after payment.</li>
</ol>

<h2 id="token-management">Token Management</h2>

<h3 id="refreshing-token">Refreshing Token</h3>

<ol>
  <li>
    <p>You will obtain a fresh <code class="language-plaintext highlighter-rouge">access_token</code> before making API calls on behalf of your users using the <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#refreshing-a-token-">Refreshing A Token</a> API call.</p>
  </li>
  <li>
    <p>A <code class="language-plaintext highlighter-rouge">refresh_token</code> is valid for <strong>six months</strong>. Calling the API to refresh the <code class="language-plaintext highlighter-rouge">access_token</code> will also get the expiration time of <code class="language-plaintext highlighter-rouge">refresh_token</code> updated. And schedule a process to run that will refresh a <code class="language-plaintext highlighter-rouge">refresh_token</code> prior to the expiration date if necessary.</p>
  </li>
  <li>
    <p>The below elements are returned with the new <code class="language-plaintext highlighter-rouge">access_token</code>, replace previously stored values for the user in your database:</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">refresh_token</code> (replace)</li>
      <li><code class="language-plaintext highlighter-rouge">refresh_expires_in</code> (replace)</li>
      <li><code class="language-plaintext highlighter-rouge">geolocation</code> (replace)</li>
    </ul>
  </li>
  <li>
    <p>If the user does not log in for <strong>six months</strong> the <code class="language-plaintext highlighter-rouge">refresh_token</code> will expire and the user’s partner account and SAP Concur account will be <strong>de-linked</strong>. To prevent this from happening, build a scheduled job that scans your database for expiration dates and refreshes tokens X days prior to expiration. Refer <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#refreshing-a-token-">Refreshing A Token API</a> for the post body description and example.</p>
  </li>
</ol>

<ul>
  <li>Watch this section of the video <a href="https://youtu.be/ikCU1235QJA?t=300">SAP Concur Integration 3 of 5 ; API Tokens</a>, which explains the difference between refresh and access tokens and how to refresh the access token.</li>
</ul>

<h3 id="revoke-token">Revoke Token</h3>

<p>You need to revoke a user’s <code class="language-plaintext highlighter-rouge">access_token</code> if the user terminates their account from your application. To revoke a user’s <code class="language-plaintext highlighter-rouge">access_token</code> call the /app-mgmt/v0/connections endpoint with a <strong>DELETE</strong> action. You are required to demonstrate your integration has the capability to revoke <code class="language-plaintext highlighter-rouge">access_token</code> for the inactive or disconnected users. 
Refer to <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#revoking-a-token-">revoking a token</a> for more details and the post example.</p>

<h2 id="being-geo-aware"><a name="being-geo-aware"></a>Being Geo Aware</h2>

<p>A client’s SAP Concur account may reside one of our many data centers. During the client onboarding process, determine in which datacenter the client’s instance resides. When your application is created, you will be provided with a <code class="language-plaintext highlighter-rouge">client_id</code>, <code class="language-plaintext highlighter-rouge">client_secret</code>, and <code class="language-plaintext highlighter-rouge">geolocation</code>. When obtaining a token, your application should use the base URI for the geolocation in which your application exists.</p>

<p>You will need to be aware of the geolocation where the user exists and make the call to the APIs correctly. As you do not know the user’s geolocation when you request the token for the first time, you should always make the API call using the <strong>default</strong> Base URI.</p>

<p>For a user hosted on both the US data center and EU data center, please use the <strong>default</strong> Base URI <code class="language-plaintext highlighter-rouge">https://glz.api.concursolutions.com</code>.</p>

<p>If you receive the error code 16 (“user lives elsewhere”) while calling the authentication service, the error message returns a new <code class="language-plaintext highlighter-rouge">geolocation</code>. Use this new ‘geolocation’ as the Base URI to call the Auth API again to get the token.</p>

<p>For example, if you make following API call to <code class="language-plaintext highlighter-rouge">https://us2.api.concursolutions.com</code> by mistake:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/oauth2/v0/token</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">us2.api.concursolutions.com</span>
<span class="s">.....</span>
</code></pre></div></div>

<p>You will get a HTTP 400 error with error code 16 like below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP 400 Bad Request
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_request"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"concur-correlationid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{correlation_id}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"error_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user lives elsewhere"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w">
  </span><span class="nl">"geolocation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://us.api.concursolutions.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>You should make another call to <code class="language-plaintext highlighter-rouge">https://us.api.concursolutions.com</code> which is the <code class="language-plaintext highlighter-rouge">geolocation</code> value returned in error message.</p>

<blockquote>
  <p><strong>Note</strong>: <em>This <code class="language-plaintext highlighter-rouge">geolocation</code> value might NOT be user token’s geolocation. It only redirects you to the correct API endpoint</em>.</p>
</blockquote>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/oauth2/v0/token</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">us.api.concursolutions.com</span>
<span class="s">.....</span>
</code></pre></div></div>

<p>Then you will get the user access token with the correct user geolocation.</p>

<blockquote>
  <p><strong>Note</strong>: <em>When obtaining the <code class="language-plaintext highlighter-rouge">access_token</code> via an authentication API, the geolocation data will be included in the response. The geolocation should be stored along with the <code class="language-plaintext highlighter-rouge">access_token</code>. Your app will then be able to make subsequent calls using the token and the correct end points based on the geolocation.</em></p>
</blockquote>

<h3 id="base-uri">Base URI</h3>

<p>When making API calls, the appropriate base URI should be used. There are three different scenarios:</p>

<ul>
  <li>Obtaining a token for a user.</li>
  <li>Refreshing a token.</li>
  <li>Calling other APIs.</li>
</ul>

<p>The base URI for obtaining a token will use your application’s geolocation. The base URI for refreshing tokens and all other API calls will use the token’s geolocation.</p>
<ul>
  <li>GLZ = <a href="https://glz.api.concursolutions.com">https://glz.api.concursolutions.com</a></li>
  <li>US2 Production = <a href="https://us2.api.concursolutions.com">https://us2.api.concursolutions.com</a></li>
  <li>EU2 Production = <a href="https://EU2.api.concursolutions.com">https://EU2.api.concursolutions.com</a></li>
</ul>

<p>When obtaining a token, your application should use the base URI corresponding to the grant type being performed, as follows:</p>

<table>
  <thead>
    <tr>
      <th>Grant Type</th>
      <th>URI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Authorization</td>
      <td>Use the GLZ base URI</td>
    </tr>
    <tr>
      <td>Password (credtype = authtoken)</td>
      <td>Use the GLZ base URI</td>
    </tr>
    <tr>
      <td>One Time Password</td>
      <td>Use the base URI corresponding to the user’s geolocation</td>
    </tr>
  </tbody>
</table>

<p>When obtaining the token, the token’s geolocation will be included in the response. The token’s geolocation should be stored along with the token. Your application will then make subsequent calls using the token and the correct endpoints based on the token’s geolocation.</p>

<p>The full list of available token geolocations is available on the <a href="https://developer.concur.com/platform/base-uris.html">Base URIs</a> page.</p>

<h2 id="posting-ereceipts">Posting eReceipts</h2>

<p>For information on getting started with <a href="https://developer.concur.com/api-reference/receipts/get-started.html">Receipts v4</a>.</p>

<ul>
  <li>You should select General eReceipt type or Grand Transportation eReceipt type from the <a href="https://developer.concur.com/api-reference/receipts/supported-receipt-types.html">Supported Receipt type</a> list and retrieve the list <a href="https://developer.concur.com/api-reference/receipts/get-started.html">schemas</a> for the selected receipt types.</li>
  <li>To ensure that you are using the correct endpoint URLs, the safest practice is to check the service index before every request. <a href="https://developer.concur.com/api-reference/receipts/endpoints.html#endpoint-service-index">Get service Index</a></li>
  <li>We generate a standard receipt if you do not provide a receipt image.</li>
  <li>We can display your app logo in standard generated receipts (size 100x100 px). Please send your company logo image file (.png) to <a href="mailto:PlatformCertification@sap.com">PlatformCertification@sap.com</a>.</li>
  <li>If your app currently generates a receipt image, (.png, .jpg, .tif, .pdf, or other image file), you can include it in your post. Follow the requirement of <a href="https://developer.concur.com/api-reference/receipts/endpoints.html#definitions-of-resources">supported image formats</a> if you are posting the eReceipts with images.</li>
</ul>

<h3 id="post-a-general-ereceipt">Post a General eReceipt</h3>

<ol>
  <li>Obtain a fresh <code class="language-plaintext highlighter-rouge">access_token</code> for the user using <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#refresh_token">refresh grant</a>.</li>
  <li>You will need the user <strong>id</strong> previously stored in the user’s profile to post receipts on their behalf.</li>
  <li>Post receipt using the <a href="https://developer.concur.com/api-reference/receipts/endpoints.html#endpoint-post-a-receipt">Post Receipt</a> endpoint.</li>
  <li>You should store the <code class="language-plaintext highlighter-rouge">concur-correlationid</code> and the <strong>Location</strong> link from the response headers even for successful responses, this will facilitate support efforts in case of a missing receipt from a user’s SAP Concur account.</li>
  <li>A general eReceipt is not mapped to any expense type. When a user adds the eReceipt into the expense report, the expense entry’s expense type will be “Undefined”. The user needs to change the expense type accordingly.</li>
</ol>

<p>The general eReceipt schema includes all receipt core definitions.</p>

<p><strong>Example: Posting a General e-Receipt</strong></p>

<p><strong>Request</strong></p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">   </span><span class="nf">POST</span> <span class="nn">/receipts/v4/users/{UUID}</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="s">   Host: {HOST}</span>
<span class="s">   Authorization: Bearer {ACCESS_TOKEN}</span>
<span class="s">   Link: &lt;http://schema.concursolutions.com/general-receipt.schema.json&gt;; rel="describedBy"</span>
<span class="s">   Content-Type: application/json</span>
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="p">{</span><span class="w">
    </span><span class="nl">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Frosch Booking Fee"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"dateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-12T09:19:02-0500"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333.00"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333.00"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"taxesTotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.00"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"currencyCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"seller"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Frosch"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Booking Fee"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"internetAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://frosch.com/"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"streetAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"One Greenway Plaza, Suite 800"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"addressLocality"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Houston"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"addressRegion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TX"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"addressCountry"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USA"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"postalCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"77046"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"taxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.00"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"payments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333.00"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"lineItems"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sequenceNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Frosch Invoice"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Agency Record Locator: VDVSWW Invoice #6810119"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"unitCost"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333.00"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333.00"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"taxesTotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.00"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"333.00"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"taxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.00"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p><strong>Response</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      HTTP/1.1 201 OK
</code></pre></div></div>
<p><strong>Response Header</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   ...
   Content-Length: 0
   Concur-correlationid: c559ab367ff8436d1d0c4ffe917664a3
   Link:&lt;http://schema.concursolutions.com/general-receipt.schema.json&gt;; rel="describedBy", &lt;https://us2.api.concursolutions.com/receipts/v4/status/eed70d8a344e4b8c9d8ad2b7b37c34e2&gt;; rel="processing-status"
   Location: https://us2.api.concursolutions.com/receipts/v4/eed70d8a344e4b8c9d8ad2b7b37c34e2
   ...
</code></pre></div></div>

<p>Receipt is now shown in the Available Expense list and the receipt Expense Type is “Undefined”.</p>

<p><img src="/assets/img/api-guides/e-receipts/ereceipt-in-available-expenses-list.png" alt="Receipt In The Available Expenses List" /></p>

<p><strong>Example: Posting a General e-Receipt with Image</strong></p>

<p><strong>Request</strong></p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/receipts/v4/users/{UUID}</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">{HOST}</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer {ACCESS_TOKEN}</span>
<span class="na">Link</span><span class="p">:</span> <span class="s">&lt;http://schema.concursolutions.com/general-receipt.schema.json&gt;; rel="describedBy"</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">multipart/form-data;</span>
<span class="na">Content-Disposition</span><span class="p">:</span> <span class="s">form-data; name="image"; filename="receipt_image.pdf"</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/pdf</span>
<span class="na">Content-Disposition</span><span class="p">:</span> <span class="s">form-data; name="receipt"</span>
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
      </span><span class="nl">"dateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-10-22T13:00:00+0800"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"91310000"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"seller"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"taxId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MA1FL0TJ7J"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABC Corporation"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">","</span><span class="p">,</span><span class="w">
      </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
               </span><span class="nl">"streetAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"225 32nd Ave"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"addressLocality"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Seattle"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"addressRegion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WA"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"addressCountry"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="w">
               </span><span class="p">}</span><span class="w">
         </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"180.0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"taxesTotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20.0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"160.0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"payments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
         </span><span class="p">{</span><span class="w">
               </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"180.0"</span><span class="w">
         </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"currencyCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div>

<p><strong>Response</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   HTTP/1.1 201 OK
</code></pre></div></div>

<h3 id="post-a-ground-transportation-ereceipt">Post a Ground Transportation eReceipt</h3>

<ol>
  <li>Obtain a fresh <code class="language-plaintext highlighter-rouge">access_token</code> for the user using <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#refresh_token">refresh grant</a>.</li>
  <li>You will need the user <strong>id</strong> previously stored in the user’s profile to post receipts on their behalf.</li>
  <li>Post receipt using the <a href="https://developer.concur.com/api-reference/receipts/endpoints.html#endpoint-post-a-receipt">Post Receipt</a> endpoint.</li>
  <li>You should store the <code class="language-plaintext highlighter-rouge">concur-correlationid</code> and the <strong>Location</strong> link from the response headers even for successful responses, this will facilitate support efforts in case of a missing receipt from the user’s SAP Concur account.</li>
  <li>The <a href="https://developer.concur.com/api-reference/receipts/supported-receipt-types.html#ground-transport-receipt">Ground Transportation eReceipt Schema</a> includes all forms of non-aerial transportation and all <a href="https://developer.concur.com/api-reference/receipts/supported-receipt-types.html#receipt-core-definitions">Receipt Core Definition</a>.</li>
</ol>

<p>Refer to the <a href="https://developer.concur.com/api-reference/receipts/sample-receipts.html#ground-transport">Grand Transportation eReceipt</a> post example.</p>

<h3 id="response-codes">Response Codes</h3>

<p>Response Codes (Success/Failure) Can be found at:</p>

<p><a href="https://developer.concur.com/api-reference/receipts/response-codes.html">https://developer.concur.com/api-reference/receipts/response-codes.html</a></p>

<h2 id="posting-quick-expenses">Posting Quick Expenses</h2>

<p>The Quick Expense API can be used to create an expense with basic information such as date, amount, and expense type, with or without a receipt image. This expense can be added to an expense report within Concur Expense, allowing the user to provide additional details such as attendees, itemizations, etc.</p>

<h3 id="creating-a-quick-expense">Creating a Quick Expense</h3>

<ol>
  <li>Obtain a fresh <code class="language-plaintext highlighter-rouge">access_token</code> for the user using <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#refresh_token">refresh grant</a>.</li>
  <li>You will need the user <strong>id</strong> previously stored in the user’s profile to post receipts on their behalf.</li>
  <li>Post the quick expense using the <a href="https://developer.concur.com/api-reference/expense/quick-expense/v4.quick-expense.html#create-a-quick-expense-">Quick Expense</a> endpoint.</li>
  <li>You should store the <code class="language-plaintext highlighter-rouge">concur-correlationid</code> from the response headers and the <code class="language-plaintext highlighter-rouge">quickExpenseIdUri</code> from the response body. This will facilitate support efforts in case of a missing quick expense from user’s SAP Concur account.</li>
  <li>The <a href="https://developer.concur.com/api-reference/expense/quick-expense/v4.quick-expense.html#schema-">Quick Expense Schema</a> includes required fields of <code class="language-plaintext highlighter-rouge">expenseTypeId</code>, <code class="language-plaintext highlighter-rouge">transactionAmount</code>, and <code class="language-plaintext highlighter-rouge">transactionDate</code>.</li>
  <li>
    <p>The supported <code class="language-plaintext highlighter-rouge">expenseTypeId</code> value can be retrieved from <a href="https://developer.concur.com/api-reference/expense/expense-report/expense-group-configurations.html">Expense Group Configurations v3.0</a>. The frequently used <code class="language-plaintext highlighter-rouge">expenseTypeId</code> values are listed  below:</p>

    <table>
      <thead>
        <tr>
          <th>expenseTypeId</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>AIRFR</td>
          <td>Airfare</td>
        </tr>
        <tr>
          <td>AWRDS</td>
          <td>Gifts - Clients</td>
        </tr>
        <tr>
          <td>BANKF</td>
          <td>Bank Fees</td>
        </tr>
        <tr>
          <td>BRKFT</td>
          <td>Breakfast</td>
        </tr>
        <tr>
          <td>BUSML</td>
          <td>Entertainment - Clients</td>
        </tr>
        <tr>
          <td>CARRT</td>
          <td>Car Rental</td>
        </tr>
        <tr>
          <td>CELPH</td>
          <td>Mobile/Cellular Phone</td>
        </tr>
        <tr>
          <td>DINNR</td>
          <td>Dinner</td>
        </tr>
        <tr>
          <td>DUESX</td>
          <td>Professional Subscriptions/Dues</td>
        </tr>
        <tr>
          <td>GASXX</td>
          <td>Fuel</td>
        </tr>
        <tr>
          <td>GIFTS</td>
          <td>Gifts - Staff</td>
        </tr>
        <tr>
          <td>LNDRY</td>
          <td>Laundry</td>
        </tr>
        <tr>
          <td>LOCPH</td>
          <td>Telephone/Fax</td>
        </tr>
        <tr>
          <td>LODNG</td>
          <td>Hotel</td>
        </tr>
        <tr>
          <td>LUNCH</td>
          <td>Lunch</td>
        </tr>
        <tr>
          <td>MILEG</td>
          <td>Personal Car Mileage</td>
        </tr>
        <tr>
          <td>MISCL</td>
          <td>Miscellaneous</td>
        </tr>
        <tr>
          <td>OFCSP</td>
          <td>Office Equipment/Hardware</td>
        </tr>
        <tr>
          <td>ONLIN</td>
          <td>Internet/Online Fees</td>
        </tr>
        <tr>
          <td>PARKG</td>
          <td>Parking</td>
        </tr>
        <tr>
          <td>POSTG</td>
          <td>Postage</td>
        </tr>
        <tr>
          <td>SEMNR</td>
          <td>Seminar/Course fees</td>
        </tr>
        <tr>
          <td>TAXIX</td>
          <td>Taxi</td>
        </tr>
        <tr>
          <td>TOLLS</td>
          <td>Tolls/Road Charges</td>
        </tr>
        <tr>
          <td>TRAIN</td>
          <td>Public Transport</td>
        </tr>
        <tr>
          <td>TRDSH</td>
          <td>Marketing/Promotional Costs</td>
        </tr>
        <tr>
          <td>01004</td>
          <td>Entertainment - Staff</td>
        </tr>
        <tr>
          <td>01005</td>
          <td>Courier/Shipping/Freight</td>
        </tr>
        <tr>
          <td>01006</td>
          <td>Printing/Photocopying/Stationery</td>
        </tr>
        <tr>
          <td>01007</td>
          <td>Office Supplies/Software</td>
        </tr>
        <tr>
          <td>01009</td>
          <td>Tips/Gratuities</td>
        </tr>
        <tr>
          <td>01012</td>
          <td>Tuition/Training Reimbursement</td>
        </tr>
        <tr>
          <td>01025</td>
          <td>Train</td>
        </tr>
        <tr>
          <td>01027</td>
          <td>Business Meals (Attendees)</td>
        </tr>
        <tr>
          <td>01028</td>
          <td>Individual Meals</td>
        </tr>
      </tbody>
    </table>
  </li>
</ol>

<p><strong>Example: Posting a Quick Expense</strong></p>

<p><strong>Request</strong></p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/quickexpense/v4/users/{UUID}/context/TRAVELER/quickexpenses</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">{HOST}</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer {ACCESS_TOKEN}</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"Comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Business Meal"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"expenseTypeId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BUSML"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bellevue"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"countryCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"countrySubDivisionCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US-WA"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ARIA"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"paymentTypeId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CASHX"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"transactionAmount"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"currencyCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="mf">120.00</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"transactionDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-12-12"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"Vendor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ARIA"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Response</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 201 OK
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"mobileEntryKeyUri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://us2.api.concursolutions.com/quickexpense/v4/users/{UUID}/context/TRAVELER/quickexpenses/1234157338"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"quickExpenseIdUri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://us2.api.concursolutions.com/quickexpense/v4/users/{UUID}/context/TRAVELER/quickexpenses/506CF67C85BA436097F434F39CAE7DD8"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The sample quick expense item is now shown in the Available Expense list.</p>

<p><img src="/assets/img/api-guides/e-receipts/quick-expense-sample.png" alt="Quick Expense In The Available Expenses List" /></p>

<h2 id="postman-sample-collections">Postman Sample Collections</h2>

<p>Click following links to download the postman sample collection zip file or click the ‘Run in Postman’ button to fork the collection to your workspace or import the collection to Postman.</p>

<ul>
  <li><a href="/api-guides/postman/auth-api-samples-postman-collection.json.zip">Authentication API Postman Collection</a> <br />
<a href="https://app.getpostman.com/run-collection/2623947-1f08de2e-55ea-4d9f-8af2-5eb5feea8553?action=collection%2Ffork&amp;collection-url=entityId%3D2623947-1f08de2e-55ea-4d9f-8af2-5eb5feea8553%26entityType%3Dcollection%26workspaceId%3Dc715a4cd-a1cd-4378-8a96-61814a68e3ef"><img src="https://run.pstmn.io/button.svg" alt="Run in Postman - Authentication API" /></a></li>
  <li><a href="/api-guides/postman/general-ereceipt-samples-postman-collection.json.zip">General eReceipt Postman Collection</a> <br />
<a href="https://app.getpostman.com/run-collection/2623947-9f48740a-806f-43d7-89de-49cd4d90f2fa?action=collection%2Ffork&amp;collection-url=entityId%3D2623947-9f48740a-806f-43d7-89de-49cd4d90f2fa%26entityType%3Dcollection%26workspaceId%3Dc715a4cd-a1cd-4378-8a96-61814a68e3ef"><img src="https://run.pstmn.io/button.svg" alt="Run in Postman - General eReceipt" /></a></li>
  <li><a href="/api-guides/postman/ground-transportation-ereceipt-samples-postman-collection.json.zip">Ground Transportation eReceipt Postman Collection</a> <br />
<a href="https://app.getpostman.com/run-collection/2623947-adc62397-c280-478c-bc35-a00c27b5db91?action=collection%2Ffork&amp;collection-url=entityId%3D2623947-adc62397-c280-478c-bc35-a00c27b5db91%26entityType%3Dcollection%26workspaceId%3Dc715a4cd-a1cd-4378-8a96-61814a68e3ef"><img src="https://run.pstmn.io/button.svg" alt="Run in Postman - Grand Transportaion eReceipt" /></a></li>
  <li><a href="/api-guides/postman/quick-expense-samples-postman-collection.json.zip">Quick Expense Postman Collection</a> <br />
<a href="https://app.getpostman.com/run-collection/2623947-5bce9efe-3ace-43dc-a930-62c4ec95fcd1?action=collection%2Ffork&amp;collection-url=entityId%3D2623947-5bce9efe-3ace-43dc-a930-62c4ec95fcd1%26entityType%3Dcollection%26workspaceId%3Dc715a4cd-a1cd-4378-8a96-61814a68e3ef"><img src="https://run.pstmn.io/button.svg" alt="Run in Postman - Quick Expense" /></a></li>
</ul>

<h2 id="creating-and-updating-an-app-center-listing"><a name="creating-and-updating-an-app-center-listing"></a>Creating and Updating an App Center Listing</h2>

<p>You need to send the complete landing page content to <a href="mailto:concur_appcentermarketing@sap.com">concur_appcentermarketing@sap.com</a> for review prior to scheduling the certification call with <a href="mailto:PlatformCertification@sap.com">PlatformCertification@sap.com</a>. This includes:</p>

<ul>
  <li>App Center Listing Form (<a href="https://developer.concur.com/manage-apps/go-market-docs/app-center-partner-listing-form.docx">Download</a>)</li>
  <li>Listing Images (Please follow the image specification in the App Center Listing Form.)</li>
</ul>

<p>The App Center Marketing team will review your content for clarity, ease of reading, and consistency with the SAP Concur brand guidelines. The App Center Marketing team will return it with any comments or suggestions. Please plan for a 10 to 14-day turnaround window for the review process.</p>

<p>Once your content is finalized, your listing will be queued for launch on an agreed upon date. Your app must be certified prior to launch.</p>

<p>Please visit <a href="https://developer.concur.com/manage-apps/go-to-market.html">Go To Market</a> page to prepare your SAP Concur App Center launch.</p>

<p>User Connection apps are launched on the following <a href="https://developer.concur.com/manage-apps/go-market-docs/apps-for-me-release-schedule.html">release dates</a>.</p>

<h2 id="error-handling">Error Handling</h2>

<h3 id="retry-logic-for-timeouts">Retry Logic for Timeouts</h3>

<p>Your app should have the retry logic for any API call timeout. For example, retry for every 30 seconds if you get the API call timeout and retry 5 ~ 10 times.</p>

<h3 id="http-response-code-and-error-codes">HTTP Response Code and Error Codes</h3>

<p>HTTP responses with status code of 4xx, 5xx are all treated as errors. The HTTP response body contains the details of the error, including error code, error name, error description, etc.</p>

<p>For example, 4xx class errors have a JSON response with the following fields.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;number&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;error&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"error_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;error_descriptio&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"geolocation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;geolocation_url_where_user_lives&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Please refer to the Authentication <a href="https://developer.concur.com/api-reference/authentication/apidoc.html#response-codes-">Response Codes</a> list for more details about Authentication errors.</p>

<p>Please refer to the Receipts v4 API <a href="https://developer.concur.com/api-reference/receipts/response-codes.html#receipts-v4---response-codes">Response Codes</a> list for more details about receipts errors.</p>

<h3 id="error-401">Error 401</h3>

<p>Error 401 is an authentication related error. A 401 will be returned when the JWT used for authentication is valid, but doesn’t match the correct user. When using a user JWT, the request must be to a URL for the same user that is represented in the JWT.</p>

<h3 id="error-403">Error 403</h3>

<p>Error 403 is an authentication related error. A 403 will be returned if there is no JWT in the authorization header of the request, or if the JWT is invalid or expired.</p>

<p><strong>Example:</strong></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_grant"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"concur-correlationid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"72a8bb8479.........02244b8"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"error_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bad or expired refresh token"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">108</span><span class="p">,</span><span class="w">
   </span><span class="nl">"geolocation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://us2.api.concursolutions.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>This response is also for cases where the JWT does not include the scope required to fulfill the request.</p>

<h3 id="error-404">Error 404</h3>

<p>The receipt(s) you requested could not be found. Check that the receipt and/or user ID are correct.</p>

<h3 id="error-500503">Error 500/503</h3>

<p>Error 500 is an internal server error. If you receive an error 500 while posting an eReceipt, you should retry the API at least 3 times. If you still encounter an error 500 after retrying, please log a support ticket.</p>

<h3 id="error-logging">Error Logging</h3>

<p>If you receive an error while calling an API, please save the error code, error message, error responses body. You must save the <code class="language-plaintext highlighter-rouge">concur-correlationId</code> from the API response header, which is required to log the support ticket.</p>

<h2 id="faq">FAQ</h2>

<h3 id="how-can-i-get-support-during-the-development-phase">How can I get support during the development phase?</h3>

<p>You should send your questions to <a href="mailto:PlatformCertification@sap.com">PlatformCertification@sap.com</a>. We will review your request/questions and will reply within 5 business days.</p>

<h3 id="how-do-i-schedule-the-certification-walkthrough">How do I schedule the certification walkthrough?</h3>

<p>There will be a one week certification time window per month. You should send your certification walkthrough request to <a href="mailto:PlatformCertification@sap.com">PlatformCertification@sap.com</a> one month before the certification date you would like schedule. We will reply with a meeting invitation within 5 business days.</p>

<p>Please find your certification date time based on the <a href="user-app-certification-calender.pdf">certification calendar</a>.</p>

<h3 id="how-do-i-log-a-support-case">How do I log a support case?</h3>

<p>You should be provide the contact detail to your SAP Concur BD/Alliance manager or <a href="mailto:PlatformCertification@sap.com">PlatformCertification@sap.com</a> for creating an account on the partner support portal.</p>

<p>To log a support case, please login and open a partner support case from <a href="https://sapconcur.my.salesforce.com/secur/login_portal.jsp?orgId=00D600000007Dq3&amp;portalId=06060000000PrEi">partner support portal</a>. You will need to provide the <a href="https://developer.concur.com/tools-support/support.html#how-to-log-a-support-case">required information</a> when logging a support case.</p>

<h3 id="where-can-i-find-api-or-product-update-information">Where can I find API or product update information?</h3>

<p>The SAP Concur API monthly updates can be found in the <a href="https://developer.concur.com/tools-support/release-notes/index.html">Developer Platform Release Notes</a>.</p>

<p>The SAP Concur product related update can be found in the <a href="http://www.concurtraining.com/customers/tech_pubs/RN_shared_planned/_client_shared_RN_all.htm">Client Shared Release Notes</a>.</p>

      </div>
      <!--/col-md-8-->
      
      <div id="markdown-toc"
           class="col-md-2 markdown-toc">
        <div class="markdown-toc-header">
    <h4>On this page</h4>
</div>
<div class="markdown-toc-content">
</div>

      </div>
      <!--/col-md-1-->
      
    </div>
    <!--/row-->
  </div>
  <!--/container-->

  <!-- TOCBOT -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>

<script>
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: '.markdown-toc-content',
    // Where to grab the headings to build the table of contents.
    contentSelector: '.markdown-body',
    // Which headings to grab inside of the contentSelector element.
    headingSelector: 'h1, h2',
    // For headings inside relative or absolute positioned containers within content.
    hasInnerContainers: false,
  });
</script>


    </div>

    <footer class="hidden-print"
        id="footer">
  <div class="col-md-8 footer-copyright">
    <p>
      &copy;
      <script type="text/javascript">
        document.write(new Date().getFullYear());
      </script>
      All Rights Reserved.
      <a href="https://www.concur.com/en-us/privacy-policy">Privacy Policy</a> |
      <a href="/terms-of-use-2021.html">Terms of Use</a> |
      <a href="/tools-support/deprecation-policy.html">API Deprecation Policy</a> |
      <a href="/legal-disclosure.html">Legal Disclosure</a> |
      <a href="https://github.com/SAP-docs/preview.developer.concur.com/blob/main/src/api-guides/e-receipts.markdown">Edit this page on GitHub</a>
    </p>
  </div>

  <!-- Social Links -->
  <div class="col-md-4 footer-social">
    <ul class="list-inline social-icons">
      <li>
        <a href="https://www.facebook.com/SAPConcur"
           target="_blank">
          <span class="sr-only">Facebook</span>
          <span class="fa-stack fa-lg">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-facebook-f fa-stack-1x fa-inverse"></i>
          </span>
        </a>
      </li>
      <li>
        <a href="https://www.linkedin.com/company/5822"
           target="_blank">
          <span class="sr-only">LinkedIn</span>
          <span class="fa-stack fa-lg">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-linkedin-in fa-stack-1x fa-inverse"></i>
          </span>
        </a>
      </li>
      <li>
        <a href="https://twitter.com/sapconcur"
           target="_blank">
          <span class="sr-only">Twitter</span>
          <span class="fa-stack fa-lg">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
          </span>
        </a>
      </li>
      <li>
        <a href="https://www.youtube.com/playlist?list=PLLNSVdjqNPVseaDkR5hSF4CDjnlLK7_nq"
           target="_blank">
          <span class="sr-only">Youtube</span>
          <span class="fa-stack fa-lg">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
          </span>
        </a>
      </li>
    </ul>
  </div>
  <!-- End Social Links -->
</footer>
<!--/.footer-->

  </div>
  <!--/wrapper-->

  <!-- JS Global Compulsory -->
<script type="text/javascript" src="/assets/plugins/jquery/jquery.min.js"></script>
<script type="text/javascript" src="/assets/plugins/jquery/jquery-migrate.min.js"></script>
<script type="text/javascript" src="/assets/plugins/bootstrap/js/bootstrap.min.js"></script>

<!-- Adobe Analytics Global-->
<script src="https://assets.adobedtm.com/e1226b306979/aeb854337dc8/launch-85c98625c1e8.min.js" async></script>

<!-- Swagger -->
<!-- <script src="/swagger-ui/lib/jquery-1.8.0.min.js" type="text/javascript"></script> -->



<script>
  var replacementURL = "preview.developer.concur.com/api-explorer-proxy";
</script>



<!-- JS Implementing Plugins -->
<script type="text/javascript" src="/assets/plugins/back-to-top.js"></script>
<!-- JS Page Level -->
<script type="text/javascript" src="/assets/js/app.js"></script>
<script type="text/javascript">
  jQuery(document).ready(function() {
    App.init();
  });
</script>

<script>
  var oHeader = document.getElementById("header-navbar");
  var oContent = document.getElementById("main-content");
  var oFooter = document.getElementById("footer");

  // Set content overall height
  var iNewHeight = oContent.offsetHeight - (oHeader.offsetHeight + oFooter.offsetHeight);
  var sHeight = "" + iNewHeight + "px";
  oContent.style.height = sHeight;

  // Set Triple component heights.
  // var oBreadcrumb = document.getElementById("breadcrumbs");
  var oLeftNav = document.getElementById("left-navigation");
  var oMDContent = document.getElementById("markdown-body");
  var oMDToc = document.getElementById("markdown-toc");
  var iViewWidth = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0)

  // Widths are 2-8-2 or 2-10 if no MDToc
  var sWidth;
  if (iViewWidth < 989) {
    if (!!oLeftNav) {
      oLeftNav.style.height = 100;
      sWidth = "" + (window.innerWidth * 0.950) + "px";
      oLeftNav.style.maxWidth = sWidth;
    }
  } else {
    if (!!oLeftNav) {
      oLeftNav.style.height = sHeight;
      sWidth = "" + (window.innerWidth * 0.166) + "px";
      oLeftNav.style.maxWidth = sWidth;
    }
    if (!!oMDContent) {
      oMDContent.style.height = sHeight;
      if (!!oMDToc) {
        // 8 / 12
        sWidth = "" + (window.innerWidth *0.66) + "px";
        oMDContent.style.maxWidth = sWidth;
      } else {
        // 10 / 12
        oMDContent.style.maxWidth = window.innerWidth * 0.833;
        sWidth = "" + (window.innerWidth * 0.833) + "px";
        oMDContent.style.maxWidth = sWidth;
      }
    }
    if (!!oMDToc) {
      oMDToc.style.height = sHeight;
      sWidth = "" + (window.innerWidth * 0.166) + "px";
      oMDToc.style.maxWidth = sWidth;
    }
  }
</script>


</body>

</html>
